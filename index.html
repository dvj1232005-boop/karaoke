<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Karaoke Trung + Pinyin</title>

<!-- PWA -->
<meta name="theme-color" content="#0f0f0f">
<link rel="manifest" href="data:application/json,{
  &quot;name&quot;:&quot;Karaoke Trung + Pinyin&quot;,
  &quot;short_name&quot;:&quot;Karaoke CN&quot;,
  &quot;start_url&quot;:&quot;.&quot;,
  &quot;display&quot;:&quot;standalone&quot;,
  &quot;background_color&quot;:&quot;#0f0f0f&quot;,
  &quot;theme_color&quot;:&quot;#0f0f0f&quot;
}">

<style>
:root{
  --bg:#0f0f0f;
  --text:#ffffff;
  --accent:#00ffcc;
  --sub:#aaaaaa;
}
.light{
  --bg:#f5f5f5;
  --text:#111;
  --accent:#008cff;
  --sub:#555;
}

body{
  background:var(--bg);
  color:var(--text);
  font-family:Arial, sans-serif;
  text-align:center;
  padding:12px;
  transition:.3s;
}

h1{margin:6px 0;}
audio{width:90%;max-width:420px;margin:8px 0;}

button{
  background:var(--accent);
  color:#000;
  border:none;
  padding:7px 12px;
  border-radius:6px;
  font-weight:bold;
  cursor:pointer;
  margin:4px;
}

#lyrics{
  max-width:820px;
  margin:auto;
  max-height:65vh;
  overflow-y:auto;
  scroll-behavior:smooth;
}

.line{
  margin:22px 0;
  opacity:.35;
  cursor:pointer;
}

.cn{font-size:24px;font-weight:bold;}
.py{font-size:15px;color:var(--sub);margin-top:4px;}

.word{opacity:.25;transition:.2s;}
.word.active{
  opacity:1;
  color:var(--accent);
  text-shadow:0 0 6px var(--accent);
}

.active{opacity:1;}
.hide-py .py{display:none;}
</style>
</head>

<body>

<h1>ðŸŽ¤ Karaoke Trung + Pinyin</h1>

<audio id="audio" controls>
  <source src="musicc.m4a" type="audio/mp4">
</audio>

<br>
<button id="togglePy">áº¨n Pinyin</button>
<button id="toggleTheme">ðŸŒ™ Dark</button>

<div id="lyrics"></div>

<script>
// ===== THEME =====
const themeBtn=document.getElementById("toggleTheme");
const savedTheme=localStorage.getItem("theme");
if(savedTheme==="light"){document.body.classList.add("light");themeBtn.textContent="â˜€ï¸ Light";}
themeBtn.onclick=()=>{
  document.body.classList.toggle("light");
  const isLight=document.body.classList.contains("light");
  themeBtn.textContent=isLight?"â˜€ï¸ Light":"ðŸŒ™ Dark";
  localStorage.setItem("theme",isLight?"light":"dark");
};

// ===== PINYIN =====
const lyricsDiv=document.getElementById("lyrics");
const pyBtn=document.getElementById("togglePy");
let showPy=true;
pyBtn.onclick=()=>{
  showPy=!showPy;
  lyricsDiv.classList.toggle("hide-py");
  pyBtn.textContent=showPy?"áº¨n Pinyin":"Hiá»‡n Pinyin";
};

// ===== KARAOKE DATA (FULL) =====
const audio=document.getElementById("audio");
const lyrics=[
{t:0,c:"æˆ‘ å–œ æ¬¢ ä½ ",p:"WÇ’ xÇ huÄn nÇ"},
{t:3,c:"æˆ‘ ä¸ å–œ æ¬¢ ä½ ",p:"WÇ’ bÃ¹ xÇ huÄn nÇ"},
{t:10,c:"é‚£",p:"NÃ "},
{t:12,c:"é‚£ æˆ‘ å† æƒ³ æƒ³ åŠž æ³•",p:"NÃ  wÇ’ zÃ i xiÇŽng xiÇŽng bÃ n fÇŽ"},
{t:31,c:"æˆ‘ å–œ æ¬¢ ä½  çš„ çœ¼ ç›",p:"WÇ’ xÇ huÄn nÇ de yÇŽn jÄ«ng"},
{t:34,c:"ä½  çš„ ç« æ¯›",p:"NÇ de jiÃ© mÃ¡o"},
{t:35,c:"ä½  çš„ å†· å‚²",p:"NÇ de lÄ›ng Ã o"},
{t:36,c:"æˆ‘ å–œ æ¬¢ ä½  çš„ çš± çº¹",p:"WÇ’ xÇ huÄn nÇ de zhÃ²u wÃ©n"},
{t:38,c:"ä½  çš„ å˜´ è§’",p:"NÇ de zuÇ jiÇŽo"},
{t:39,c:"ä½  çš„ å¾® ç¬‘",p:"NÇ de wÄ“i xiÃ o"},
{t:40,c:"æˆ‘ å–œ æ¬¢ ä½ ",p:"WÇ’ xÇ huÄn nÇ"},
{t:42,c:"å…¨ ä¸– ç•Œ éƒ½ çŸ¥ é“",p:"QuÃ¡n shÃ¬ jiÃ¨ dÅu zhÄ« dÃ o"},
{t:44,c:"å˜² ç¬‘",p:"ChÃ¡o xiÃ o"},
{t:45,c:"åˆ« é—¹",p:"BiÃ© nÃ o"},
{t:47,c:"æˆ‘ ä¼š ç»§ ç»­",p:"WÇ’ huÃ¬ jÃ¬ xÃ¹"},
{t:49,c:"è¯· ä½  å‡† å¤‡ å¥½",p:"QÇng nÇ zhÇ”n bÃ¨i hÇŽo"},
{t:51,c:"æˆ‘ å–œ æ¬¢ ä½  çš„ è¡¬ è¡«",p:"WÇ’ xÇ huÄn nÇ de chÃ¨n shÄn"},
{t:52,c:"ä½  çš„ æ‰‹ æŒ‡",p:"NÇ de shÇ’u zhÇ"},
{t:54,c:"ä½  çš„ å‘³ é“",p:"NÇ de wÃ¨i dÃ o"},
{t:56,c:"æˆ‘ æƒ³ åš ä½  çš„ æ£‰ è¢„",p:"WÇ’ xiÇŽng zuÃ² nÇ de miÃ¡n ÇŽo"},
{t:57,c:"ä½  çš„ æ‰‹ å¥—",p:"NÇ de shÇ’u tÃ o"},
{t:58,c:"ä½  çš„ å¿ƒ è·³",p:"NÇ de xÄ«n tiÃ o"},
{t:59,c:"æˆ‘ å–œ æ¬¢ ä½ ",p:"WÇ’ xÇ huÄn nÇ"},
{t:62,c:"å…¨ ä¸– ç•Œ éƒ½ æ˜Ž äº†",p:"QuÃ¡n shÃ¬ jiÃ¨ dÅu mÃ­ng liÇŽo"},
{t:63,c:"ç…Ž ç†¬",p:"JiÄn Ã¡o"},
{t:65,c:"åˆ« èµ· é—¹",p:"BiÃ© qÇ nÃ o"},
{t:67,c:"æˆ‘ å¤š è€ å¿ƒ",p:"WÇ’ duÅ nÃ i xÄ«n"},
{t:69,c:"è¯· ä½  ç­‰ ç€ å”±",p:"QÇng nÇ dÄ›ng zhe chÃ ng"},
{t:71,c:"å–œ æ¬¢ ä½  åœ¨ æ¯ ä¸€ åˆ»",p:"XÇ huÄn nÇ zÃ i mÄ›i yÃ­ kÃ¨"},
{t:74,c:"æ¯ ä¸€ ç§’",p:"MÄ›i yÃ¬ miÇŽo"},
{t:76,c:"å–œ æ¬¢ ä½  åœ¨ æ¯ ä¸€ å¤„",p:"XÇ huÄn nÇ zÃ i mÄ›i yÃ­ chÃ¹"},
{t:79,c:"æ¯ ä¸€ è§’",p:"MÄ›i yÃ¬ jiÇŽo"},
{t:80,c:"å–œ æ¬¢ ä½  å·² å˜ æˆ ä¹  æƒ¯",p:"XÇ huÄn nÇ yÇ biÃ n chÃ©ng xÃ­ guÃ n"},
{t:83,c:"éš¾ ä»¥ æˆ’ æŽ‰",p:"NÃ¡n yÇ jiÃ¨ diÃ o"},
{t:85,c:"æˆ‘ å¤š å–œ æ¬¢ ä½ ",p:"WÇ’ duÅ xÇ huÄn nÇ"},
{t:88,c:"æˆ‘ ä¸ çŸ¥ é“",p:"WÇ’ bÃ¹ zhÄ« dÃ o"},
{t:89,c:"å–œ æ¬¢ ä½  çš„ ä¸‹ é›¨ å¤©",p:"XÇ huÄn nÇ de xiÃ  yÇ” tiÄn"},
{t:92,c:"æ”¾ æ™´ äº†",p:"FÃ ng qÃ­ng le"},
{t:94,c:"å–œ æ¬¢ ä½  çš„ ä¸‹ é›ª å¤©",p:"XÇ huÄn nÇ de xiÃ  xuÄ› tiÄn"},
{t:97,c:"æ¸© æš– äº†",p:"WÄ“n nuÇŽn le"},
{t:99,c:"å–œ æ¬¢ ä½  å·² å˜ æˆ ä¿¡ ä»°",p:"XÇ huÄn nÇ yÇ biÃ n chÃ©ng xÃ¬n yÇŽng"},
{t:102,c:"éš¾ ä»¥ æ”¾ æŽ‰",p:"NÃ¡n yÇ fÃ ng diÃ o"},
{t:104,c:"æˆ‘ å¤š å–œ æ¬¢ ä½ ",p:"WÇ’ duÅ xÇ huÄn nÇ"},
{t:107,c:"ä½  ä¼š çŸ¥ é“",p:"NÇ huÃ¬ zhÄ« dÃ o"}
];

// render
lyrics.forEach(l=>{
  const line=document.createElement("div");
  line.className="line";
  line.onclick=()=>audio.currentTime=l.t;

  const cn=document.createElement("div");
  cn.className="cn";
  l.c.split(" ").forEach(w=>{
    const s=document.createElement("span");
    s.textContent=w+" ";
    s.className="word";
    cn.appendChild(s);
  });

  const py=document.createElement("div");
  py.className="py";
  py.textContent=l.p;

  line.appendChild(cn);
  line.appendChild(py);
  lyricsDiv.appendChild(line);
});

const lines=document.querySelectorAll(".line");

// sync
audio.addEventListener("timeupdate",()=>{
  const t=audio.currentTime;
  lyrics.forEach((l,i)=>{
    if(t>=l.t&&(i===lyrics.length-1||t<lyrics[i+1].t)){
      lines.forEach(x=>x.classList.remove("active"));
      const line=lines[i];
      line.classList.add("active");
      line.scrollIntoView({behavior:"smooth",block:"center"});
      line.querySelectorAll(".word").forEach((w,idx)=>{
        w.classList.remove("active");
        setTimeout(()=>w.classList.add("active"),idx*130);
      });
    }
  });
});

// PWA service worker (inline)
if("serviceWorker" in navigator){
  const swCode=`
    self.addEventListener('install',e=>{
      self.skipWaiting();
    });
    self.addEventListener('fetch',e=>{
      e.respondWith(fetch(e.request).catch(()=>new Response("Offline")));
    });
  `;
  const blob=new Blob([swCode],{type:"text/javascript"});
  navigator.serviceWorker.register(URL.createObjectURL(blob));
}
</script>

</body>
</html>
